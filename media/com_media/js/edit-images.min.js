Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},function(){"use strict";var e=Joomla.getOptions("com_media",{});if(!e)throw new Error('Initialization error "edit-images.js"');Joomla.MediaManager.Edit.original={filename:e.uploadPath.split("/").pop(),extension:e.uploadPath.split(".").pop(),contents:"data:image/"+e.uploadPath.split(".").pop()+";base64,"+e.contents},Joomla.MediaManager.Edit.history={},Joomla.MediaManager.Edit.current={};var a=function(e,a){if(a.contents){var t=document.getElementById("media-manager-edit-container"),i=document.createElement("div"),o=document.createElement("div"),n=document.createElement("img"),r=document.createElement("img");t.innerHTML="",n.src=a.contents,n.id="image-source",n.style.maxWidth="100%",r.src=a.contents,r.id="image-preview",r.style.maxWidth="100%",i.style.display="none",i.appendChild(n),t.appendChild(i),o.appendChild(r),t.appendChild(o),Joomla.MediaManager.Edit[e.toLowerCase()].Activate(a)}};Joomla.MediaManager.Edit.Reset=function(e){(!e||e&&"initial"===e)&&(Joomla.MediaManager.Edit.current.contents=Joomla.MediaManager.Edit.original.contents),document.getElementById("media-manager-edit-container").innerHTML="";var t=document.getElementById("myTab").firstElementChild;"UL"===t.tagName&&[].slice.call(t.querySelectorAll("a")).forEach(function(t){if(t.classList.contains("active")){Joomla.MediaManager.Edit[t.id.replace("tab-attrib-","").toLowerCase()].Deactivate();var i=Joomla.MediaManager.Edit.current;(!e||e&&!0!==e)&&(i=Joomla.MediaManager.Edit.original),t.click();var o=document.getElementById("media-manager-edit-container");document.getElementById(t.id.id.replace("tab-","")).insertAdjacentElement("afterbegin",o),a(t.id.replace("tab-attrib-",""),i)}})},window.addEventListener("mediaManager.history.point",function(){if(Joomla.MediaManager.Edit.original!==Joomla.MediaManager.Edit.current.contents){var e=Object.keys(Joomla.MediaManager.Edit.history).length;if(Joomla.MediaManager.Edit.history[e]&&Joomla.MediaManager.Edit.history[e-1]&&Joomla.MediaManager.Edit.history[e]===Joomla.MediaManager.Edit.history[e-1])return;Joomla.MediaManager.Edit.history[e+1]=Joomla.MediaManager.Edit.current.contents}}),Joomla.MediaManager.Edit.Undo=function(){},Joomla.MediaManager.Edit.Redo=function(){},Joomla.MediaManager.Edit.createProgressBar=function(){},Joomla.MediaManager.Edit.updateProgressBar=function(){},Joomla.MediaManager.Edit.removeProgressBar=function(){},Joomla.submitbutton=function(a){var t="jpg"===Joomla.MediaManager.Edit.original.extension?"jpeg":Joomla.MediaManager.Edit.original.extension,i=window.location.pathname.replace(/&view=file.*/g,""),o=e.uploadPath.split("/").pop(),n={name:o,content:Joomla.MediaManager.Edit.current.contents.replace("data:image/"+t+";base64,","")},r=e.uploadPath,d=e.apiBaseUrl+"&task=api.files&path="+r,l="application/json";n[e.csrfToken]="1";var c=r.split("/");switch(c.pop(),(c=c.join("/")).endsWith(":")&&(c+="/"),a){case"apply":Joomla.UploadFile.exec(o,JSON.stringify(n),r,d,l),Joomla.MediaManager.Edit.Reset(!0);break;case"save":Joomla.UploadFile.exec(o,JSON.stringify(n),r,d,l),window.location=i+"?option=com_media&path="+c;break;case"cancel":window.location=i+"?option=com_media&path="+c;break;case"reset":Joomla.MediaManager.Edit.Reset("initial")}},Joomla.UploadFile={},Joomla.UploadFile.exec=function(e,a,t,i,o){var n=new XMLHttpRequest;n.upload.onprogress=function(e){Joomla.MediaManager.Edit.updateProgressBar(e.loaded/e.total*100)},n.onload=function(){var e=void 0;try{e=JSON.parse(n.responseText)}catch(a){e=null}e?200===n.status&&(!0===e.success&&Joomla.MediaManager.Edit.removeProgressBar(),"1"===e.status&&(Joomla.renderMessages({success:[e.message]},"true"),Joomla.MediaManager.Edit.removeProgressBar())):Joomla.MediaManager.Edit.removeProgressBar()},n.onerror=function(){Joomla.MediaManager.Edit.removeProgressBar()},n.open("PUT",i,!0),n.setRequestHeader("Content-Type",o),Joomla.MediaManager.Edit.createProgressBar(),n.send(a)},document.addEventListener("DOMContentLoaded",function(){setTimeout(function e(){var t=document.getElementById("myTab").firstElementChild;if("UL"===t.tagName){var i=[].slice.call(t.querySelectorAll("a"));i[0]&&a(i[0].id.replace("tab-attrib-",""),Joomla.MediaManager.Edit.original),i.forEach(function(e){e.addEventListener("joomla.tab.shown",function(e){var t=document.getElementById("media-manager-edit-container");e.relatedTarget&&(Joomla.MediaManager.Edit[e.relatedTarget.id.replace("tab-attrib-","").toLowerCase()].Deactivate(),t.innerHTML="");var i=Joomla.MediaManager.Edit.current;"contents"in Joomla.MediaManager.Edit.current||(i=Joomla.MediaManager.Edit.original),document.getElementById(e.target.id.replace("tab-","")).insertAdjacentElement("afterbegin",t),a(e.target.id.replace("tab-attrib-",""),i)}),e.click()}),i[0]&&(i[0].click(),a(i[0].id.replace("tab-attrib-",""),Joomla.MediaManager.Edit.original))}else setTimeout(e,50)},50)})}();
