Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";var e;e="/images"+(e=function(e){for(var t=window.location.search.substring(1).split("&"),o=0;o<t.length;o++){var a=t[o].split("=");if(decodeURIComponent(a[0])==e)return decodeURIComponent(a[1])}return!1}("path").split(":"))[1];var t=function(t){Joomla.request({url:a()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+e+"&width="+t,method:"GET",onSuccess:e=>{if(""!=e){var t=JSON.parse(e);Joomla.MediaManager.Edit.focus.cropper.setData({x:t["box-left"],y:t["box-top"],width:t["box-width"],height:t["box-height"]})}}})};function o(t){var o="&box-left="+Joomla.MediaManager.Edit.focus.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.focus.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.focus.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.focus.cropper.boxHeight+"&width="+t;Joomla.request({url:a()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+e+o,method:"GET"})}function a(){var e=window.location.origin,t=window.location.pathname.split("/");return"administrator"!=t[1]?e+"/"+t[1]:e}Joomla.MediaManager.Edit.focus={Activate:function(t){i(t),function(){var e=Joomla.getOptions("js-focus-widths"),t=document.getElementById("jform_requestedWidth"),o=t.length,a=e.length;if(a>0){for(var i=0;i<o;i++)t.remove(t.i);for(e.sort(),i=0;i<a;i++){var d=document.createElement("option");d.text=e[i]+"px",d.value=e[i],t.add(d,i)}}}(),document.getElementById("delete-focus")||function(){var t=document.createElement("div");t.className="control-group";var o=document.createElement("BUTTON");o.setAttribute("type","button"),o.setAttribute("id","delete-focus"),o.setAttribute("class","btn btn-danger"),o.appendChild(document.createTextNode("Delete Focus")),o.addEventListener("click",function(){Joomla.request({url:a()+"/administrator/index.php?option=com_media&task=adaptiveimage.deleteFocus&path="+e,method:"POST"})}),t.appendChild(o),document.getElementById("attrib-focus").appendChild(t)}()},Deactivate:function(){o(document.getElementById("jform_requestedWidth").value),function(){for(var t=document.getElementById("jform_requestedWidth"),o=[],i=0;i<t.length;i++)o[i]=t[i].value;Joomla.request({url:a()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropImage&path="+e+"&widths="+JSON.stringify(o),method:"GET"})}(),Joomla.MediaManager.Edit.focus.cropper&&Joomla.MediaManager.Edit.focus.cropper.destroy()}};var i=function(e){var a=document.getElementById("image-preview");Joomla.MediaManager.Edit.focus.cropper=new Cropper(a,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:a.offsetWidth,minContainerHeight:a.offsetHeight,crop:function(e){var t,o,a,i;t=Math.round(e.detail.x),o=Math.round(e.detail.y),a=Math.round(e.detail.width),i=Math.round(e.detail.height),Joomla.MediaManager.Edit.focus.cropper.boxLeft=t,Joomla.MediaManager.Edit.focus.cropper.boxTop=o,Joomla.MediaManager.Edit.focus.cropper.boxWidth=a,Joomla.MediaManager.Edit.focus.cropper.boxHeight=i,document.getElementById("jform_data_focus_x").value=t,document.getElementById("jform_data_focus_y").value=o,document.getElementById("jform_data_focus_width").value=a,document.getElementById("jform_data_focus_height").value=i,window.dispatchEvent(new Event("mediaManager.history.point"))}}),a.addEventListener("load",function(){var e=a.naturalWidth/a.naturalHeight;Joomla.MediaManager.Edit.focus.cropper.setAspectRatio(e)});var i=document.getElementById("jform_requestedWidth"),d=i.value;t(d),i.addEventListener("change",function(){o(d);var e=i.value;t(e),d=e})}}();