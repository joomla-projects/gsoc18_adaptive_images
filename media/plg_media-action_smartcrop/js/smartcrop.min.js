Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";var e;e="/images"+(e=function(e){for(var a=window.location.search.substring(1).split("&"),o=0;o<a.length;o++){var t=a[o].split("=");if(decodeURIComponent(t[0])==e)return decodeURIComponent(t[1])}return!1}("path").split(":"))[1];var a=function(a){Joomla.request({url:t()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+e+"&width="+a,method:"GET",onSuccess:e=>{if(""!=e){var a=JSON.parse(e);Joomla.MediaManager.Edit.smartcrop.cropper.setData({x:a["box-left"],y:a["box-top"],width:a["box-width"],height:a["box-height"]})}}})};function o(a){var o="&box-left="+Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.smartcrop.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight+"&width="+a;Joomla.request({url:t()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+e+o,method:"GET"})}function t(){var e=window.location.origin,a=window.location.pathname.split("/");return"administrator"!=a[1]?e+"/"+a[1]:e}Joomla.MediaManager.Edit.smartcrop={Activate:function(e){r(e),function(){var e=Joomla.getOptions("js-smartcrop-widths"),a=document.getElementById("jform_requestedWidth"),o=a.length,t=e.length;if(t>0){for(var r=0;r<o;r++)a.remove(a.i);for(e.sort(),r=0;r<t;r++){var i=document.createElement("option");i.text=e[r]+"px",i.value=e[r],a.add(i,r)}}}()},Deactivate:function(){o(document.getElementById("jform_requestedWidth").value),Joomla.request({url:t()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropImage&path="+e,method:"GET"}),Joomla.MediaManager.Edit.smartcrop.cropper&&Joomla.MediaManager.Edit.smartcrop.cropper.destroy()}};var r=function(e){var t=document.getElementById("image-preview");Joomla.MediaManager.Edit.smartcrop.cropper=new Cropper(t,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:t.offsetWidth,minContainerHeight:t.offsetHeight,crop:function(e){var a,o,t,r;a=Math.round(e.detail.x),o=Math.round(e.detail.y),t=Math.round(e.detail.width),r=Math.round(e.detail.height),Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft=a,Joomla.MediaManager.Edit.smartcrop.cropper.boxTop=o,Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth=t,Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight=r,document.getElementById("jform_data_focus_x").value=a,document.getElementById("jform_data_focus_y").value=o,document.getElementById("jform_data_focus_width").value=t,document.getElementById("jform_data_focus_height").value=r,window.dispatchEvent(new Event("mediaManager.history.point"))}}),t.addEventListener("load",function(){var e=t.naturalWidth/t.naturalHeight;Joomla.MediaManager.Edit.smartcrop.cropper.setAspectRatio(e)});var r=document.getElementById("jform_requestedWidth"),i=r.value;a(i),r.addEventListener("change",function(){o(i);var e=r.value;a(e),i=e})}}();