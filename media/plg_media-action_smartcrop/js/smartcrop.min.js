Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";function a(a){for(var o=window.location.search.substring(1).split("&"),t=0;t<o.length;t++){var e=o[t].split("=");if(decodeURIComponent(e[0])==a)return decodeURIComponent(e[1])}return!1}function o(){var a=window.location.origin,o=window.location.pathname.split("/");return"administrator"!=o[1]?a+"/"+o[1]:a}Joomla.MediaManager.Edit.smartcrop={Activate:function(t){!function(t){var e=document.getElementById("image-preview");Joomla.MediaManager.Edit.smartcrop.cropper=new Cropper(e,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:e.offsetWidth,minContainerHeight:e.offsetHeight,crop:function(a){var o,t,r,i,d,p;o=Math.round(a.detail.x),t=Math.round(a.detail.y),r=Math.round(a.detail.width),i=Math.round(a.detail.height),d=e.naturalWidth,p=e.naturalHeight,Joomla.MediaManager.Edit.smartcrop.cropper.top=(t/p).toFixed(2),Joomla.MediaManager.Edit.smartcrop.cropper.bottom=((i+t)/p).toFixed(2),Joomla.MediaManager.Edit.smartcrop.cropper.left=(o/d).toFixed(2),Joomla.MediaManager.Edit.smartcrop.cropper.right=((r+o)/d).toFixed(2),document.getElementById("jform_data_focus_top").value=Joomla.MediaManager.Edit.smartcrop.cropper.top,document.getElementById("jform_data_focus_bottom").value=Joomla.MediaManager.Edit.smartcrop.cropper.bottom,document.getElementById("jform_data_focus_left").value=Joomla.MediaManager.Edit.smartcrop.cropper.left,document.getElementById("jform_data_focus_right").value=Joomla.MediaManager.Edit.smartcrop.cropper.right,Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft=o,Joomla.MediaManager.Edit.smartcrop.cropper.boxTop=t,Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth=r,Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight=i,window.dispatchEvent(new Event("mediaManager.history.point"))}});var r,i,d,p;i="/images"+(i=a("path").split(":"))[1],d=new XMLHttpRequest,p=o()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+i,d.open("GET",p,!0),d.onreadystatechange=function(){4==this.readyState&&200==this.status&&""!=this.response&&(r=JSON.parse(this.responseText),Joomla.MediaManager.Edit.smartcrop.cropper.setData({x:r["box-left"],y:r["box-top"],width:r["box-width"],height:r["box-height"]}))},d.send()}()},Deactivate:function(){var t=a("path");t="/images"+(t=t.split(":"))[1];var e="&data-focus-top="+Joomla.MediaManager.Edit.smartcrop.cropper.top+"&data-focus-left="+Joomla.MediaManager.Edit.smartcrop.cropper.left+"&data-focus-bottom="+Joomla.MediaManager.Edit.smartcrop.cropper.bottom+"&data-focus-right="+Joomla.MediaManager.Edit.smartcrop.cropper.right+"&box-left="+Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.smartcrop.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight,r=new XMLHttpRequest,i=o()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+t;i+=e,r.open("GET",i,!0),r.send(),Joomla.MediaManager.Edit.smartcrop.cropper&&Joomla.MediaManager.Edit.smartcrop.cropper.destroy()}}}();