Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";var a=function(a){var e,r,i,n;r="/images"+(r=t("path").split(":"))[1],i=new XMLHttpRequest,n=o()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+r+"&width="+a,i.open("GET",n,!0),i.onreadystatechange=function(){4==this.readyState&&200==this.status&&""!=this.response&&(e=JSON.parse(this.responseText),Joomla.MediaManager.Edit.smartcrop.cropper.setData({x:e["box-left"],y:e["box-top"],width:e["box-width"],height:e["box-height"]}))},i.send()};function e(a){var e=t("path");e="/images"+(e=e.split(":"))[1];var r="&box-left="+Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.smartcrop.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight+"&width="+a,i=new XMLHttpRequest,n=o()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+e;n+=r,i.open("GET",n,!0),i.send()}function t(a){for(var e=window.location.search.substring(1).split("&"),t=0;t<e.length;t++){var o=e[t].split("=");if(decodeURIComponent(o[0])==a)return decodeURIComponent(o[1])}return!1}function o(){var a=window.location.origin,e=window.location.pathname.split("/");return"administrator"!=e[1]?a+"/"+e[1]:a}Joomla.MediaManager.Edit.smartcrop={Activate:function(a){r(a)},Deactivate:function(){e(document.getElementById("jform_requestedWidth").value),function(){var a=t("path");a="/images"+(a=a.split(":"))[1];var e=new XMLHttpRequest,r=o()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropImage&path="+a;e.open("GET",r,!0),e.send()}(),Joomla.MediaManager.Edit.smartcrop.cropper&&Joomla.MediaManager.Edit.smartcrop.cropper.destroy()}};var r=function(t){var o=document.getElementById("image-preview");Joomla.MediaManager.Edit.smartcrop.cropper=new Cropper(o,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:o.offsetWidth,minContainerHeight:o.offsetHeight,crop:function(a){var e,t,o,r;e=Math.round(a.detail.x),t=Math.round(a.detail.y),o=Math.round(a.detail.width),r=Math.round(a.detail.height),Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft=e,Joomla.MediaManager.Edit.smartcrop.cropper.boxTop=t,Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth=o,Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight=r,document.getElementById("jform_data_focus_x").value=e,document.getElementById("jform_data_focus_y").value=t,document.getElementById("jform_data_focus_width").value=o,document.getElementById("jform_data_focus_height").value=r,window.dispatchEvent(new Event("mediaManager.history.point"))}}),o.addEventListener("load",function(){var a=o.naturalWidth/o.naturalHeight;Joomla.MediaManager.Edit.smartcrop.cropper.setAspectRatio(a)});var r=document.getElementById("jform_requestedWidth"),i=r.value;a(i),r.addEventListener("change",function(){e(i);var t=r.value;a(t),i=t})}}();

