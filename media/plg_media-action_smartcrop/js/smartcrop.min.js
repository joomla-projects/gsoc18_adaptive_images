Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";function t(t){for(var e=window.location.search.substring(1).split("&"),a=0;a<e.length;a++){var o=e[a].split("=");if(decodeURIComponent(o[0])==t)return decodeURIComponent(o[1])}return!1}function e(){var t=window.location.origin,e=window.location.pathname.split("/");return"administrator"!=e[1]?t+"/"+e[1]:t}Joomla.MediaManager.Edit.smartcrop={Activate:function(a){!function(a){var o=document.getElementById("image-preview");Joomla.MediaManager.Edit.smartcrop.cropper=new Cropper(o,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:o.offsetWidth,minContainerHeight:o.offsetHeight,crop:function(t){var e,a,r,i;e=Math.round(t.detail.x),a=Math.round(t.detail.y),r=Math.round(t.detail.width),i=Math.round(t.detail.height),o.naturalWidth,o.naturalHeight,Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft=e,Joomla.MediaManager.Edit.smartcrop.cropper.boxTop=a,Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth=r,Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight=i,document.getElementById("jform_data_focus_x").value=e,document.getElementById("jform_data_focus_y").value=a,document.getElementById("jform_data_focus_width").value=r,document.getElementById("jform_data_focus_height").value=i,window.dispatchEvent(new Event("mediaManager.history.point"))}}),o.addEventListener("load",function(){var t=o.naturalWidth/o.naturalHeight;Joomla.MediaManager.Edit.smartcrop.cropper.setAspectRatio(t)});var r,i,n,d;i="/images"+(i=t("path").split(":"))[1],n=new XMLHttpRequest,d=e()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+i,n.open("GET",d,!0),n.onreadystatechange=function(){4==this.readyState&&200==this.status&&""!=this.response&&(r=JSON.parse(this.responseText),Joomla.MediaManager.Edit.smartcrop.cropper.setData({x:r["box-left"],y:r["box-top"],width:r["box-width"],height:r["box-height"]}),function(t,e){t.value=null;for(var a=t.options.length,o=0;o<a;o++)e.indexOf(t.options[o].value)>=0&&(t.options[o].selected=!0)}(document.getElementById("jform_requestedWidth"),r.widths))},n.send()}()},Deactivate:function(){var a=function(t){for(var e,a=[],o=t&&t.options,r=0,i=o.length;r<i;r++)(e=o[r]).selected&&a.push(e.value||e.text);return a}(document.getElementById("jform_requestedWidth")),o=t("path");o="/images"+(o=o.split(":"))[1];var r="&box-left="+Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.smartcrop.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight+"&widths="+JSON.stringify(a),i=new XMLHttpRequest,n=e()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+o;n+=r,i.open("GET",n,!0),i.send(),Joomla.MediaManager.Edit.smartcrop.cropper&&Joomla.MediaManager.Edit.smartcrop.cropper.destroy()}}}();