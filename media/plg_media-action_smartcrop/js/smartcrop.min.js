Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";var t,e=document.getElementById("image-preview"),a=e.getContext("2d"),n={},r=!1,o=document.createElement("img"),d=0,i=0,l=1,u=1,f=e.width,m=e.height,s=f,c=m,g=function(){a.fillStyle="#ffffff",a.fillRect(0,0,f,m)};function v(){g(),a.drawImage(o,0,0,s,c)}function h(t,e,a,n,r){document.getElementById("jform_data_focus_top").value=a,document.getElementById("jform_data_focus_left").value=e,document.getElementById("jform_data_focus_bottom").value=r,document.getElementById("jform_data_focus_right").value=n}o.addEventListener("load",function(){var t=o.naturalWidth/o.naturalHeight;o.naturalHeight>m&&t<1?(s=m*t,c=m):o.naturalWidth>f&&t>1?(s=f,c=f/t):(s=o.naturalWidth,c=o.naturalHeight),v()},!1),e.addEventListener("dragover",function(t){t.preventDefault()},!1),e.addEventListener("drop",function(e){var a=e.dataTransfer.files;if(a.length>0){var n=a[0];if("undefined"!=typeof FileReader&&-1!=n.type.indexOf("image")){var r=new FileReader;r.onload=function(t){o.src=t.target.result},r.readAsDataURL(n),t=n.name,h(0,0,0,1,1)}}e.preventDefault()},!1),e.addEventListener("mousedown",function(t){n.startX=t.layerX,n.startY=t.layerY,r=!0},!1),e.addEventListener("mouseup",function(t){r=!1},!1),e.addEventListener("mousemove",function(e){r&&(v(),n.w=e.layerX-n.startX,n.h=e.layerY-n.startY,d=n.startX/s,i=n.startY/c,l=(n.w+n.startX)/s,u=(n.h+n.startY)/c,t&&h(0,d.toFixed(2),i.toFixed(2),l.toFixed(2),u.toFixed(2)),a.fillStyle="rgba(255, 0, 0, 0.3)",a.fillRect(n.startX,n.startY,n.w,n.h))},!1)}();