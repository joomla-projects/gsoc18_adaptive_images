Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";var e;e="/images"+(e=function(e){for(var t=window.location.search.substring(1).split("&"),a=0;a<t.length;a++){var o=t[a].split("=");if(decodeURIComponent(o[0])==e)return decodeURIComponent(o[1])}return!1}("path").split(":"))[1];var t=function(t){Joomla.request({url:o()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+e+"&width="+t,method:"GET",onSuccess:e=>{if(""!=e){var t=JSON.parse(e);Joomla.MediaManager.Edit.smartcrop.cropper.setData({x:t["box-left"],y:t["box-top"],width:t["box-width"],height:t["box-height"]})}}})};function a(t){var a="&box-left="+Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.smartcrop.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight+"&width="+t;Joomla.request({url:o()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+e+a,method:"GET"})}function o(){var e=window.location.origin,t=window.location.pathname.split("/");return"administrator"!=t[1]?e+"/"+t[1]:e}Joomla.MediaManager.Edit.smartcrop={Activate:function(t){r(t),function(){var e=Joomla.getOptions("js-smartcrop-widths"),t=document.getElementById("jform_requestedWidth"),a=t.length,o=e.length;if(o>0){for(var r=0;r<a;r++)t.remove(t.i);for(e.sort(),r=0;r<o;r++){var i=document.createElement("option");i.text=e[r]+"px",i.value=e[r],t.add(i,r)}}}(),function(){var t=document.createElement("div");t.className="control-group";var a=document.createElement("BUTTON");a.setAttribute("type","button"),a.setAttribute("id","delete-focus"),a.setAttribute("class","btn btn-danger"),a.appendChild(document.createTextNode("Delete Focus")),a.addEventListener("click",function(){Joomla.request({url:o()+"/administrator/index.php?option=com_media&task=adaptiveimage.deleteFocus&path="+e,method:"GET"})}),t.appendChild(a),document.getElementById("attrib-smartcrop").appendChild(t)}()},Deactivate:function(){a(document.getElementById("jform_requestedWidth").value),function(){for(var t=document.getElementById("jform_requestedWidth"),a=[],r=0;r<t.length;r++)a[r]=t[r].value;Joomla.request({url:o()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropImage&path="+e+"&widths="+JSON.stringify(a),method:"GET"})}(),Joomla.MediaManager.Edit.smartcrop.cropper&&Joomla.MediaManager.Edit.smartcrop.cropper.destroy()}};var r=function(e){var o=document.getElementById("image-preview");Joomla.MediaManager.Edit.smartcrop.cropper=new Cropper(o,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:o.offsetWidth,minContainerHeight:o.offsetHeight,crop:function(e){var t,a,o,r;t=Math.round(e.detail.x),a=Math.round(e.detail.y),o=Math.round(e.detail.width),r=Math.round(e.detail.height),Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft=t,Joomla.MediaManager.Edit.smartcrop.cropper.boxTop=a,Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth=o,Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight=r,document.getElementById("jform_data_focus_x").value=t,document.getElementById("jform_data_focus_y").value=a,document.getElementById("jform_data_focus_width").value=o,document.getElementById("jform_data_focus_height").value=r,window.dispatchEvent(new Event("mediaManager.history.point"))}}),o.addEventListener("load",function(){var e=o.naturalWidth/o.naturalHeight;Joomla.MediaManager.Edit.smartcrop.cropper.setAspectRatio(e)});var r=document.getElementById("jform_requestedWidth"),i=r.value;t(i),r.addEventListener("change",function(){a(i);var e=r.value;t(e),i=e})}}();