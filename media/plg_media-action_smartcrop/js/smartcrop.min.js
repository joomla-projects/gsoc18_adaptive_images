Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";var e;e="/images"+(e=function(e){for(var t=window.location.search.substring(1).split("&"),o=0;o<t.length;o++){var a=t[o].split("=");if(decodeURIComponent(a[0])==e)return decodeURIComponent(a[1])}return!1}("path").split(":"))[1];var t=function(t){Joomla.request({url:a()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+e+"&width="+t,method:"GET",onSuccess:e=>{if(""!=e){var t=JSON.parse(e);Joomla.MediaManager.Edit.smartcrop.cropper.setData({x:t["box-left"],y:t["box-top"],width:t["box-width"],height:t["box-height"]})}}})};function o(t){var o="&box-left="+Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.smartcrop.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight+"&width="+t;Joomla.request({url:a()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+e+o,method:"GET"})}function a(){var e=window.location.origin,t=window.location.pathname.split("/");return"administrator"!=t[1]?e+"/"+t[1]:e}Joomla.MediaManager.Edit.smartcrop={Activate:function(e){r(e),function(){var e=Joomla.getOptions("js-smartcrop-widths"),t=document.getElementById("jform_requestedWidth"),o=t.length,a=e.length;if(a>0){for(var r=0;r<o;r++)t.remove(t.i);for(e.sort(),r=0;r<a;r++){var i=document.createElement("option");i.text=e[r]+"px",i.value=e[r],t.add(i,r)}}}()},Deactivate:function(){o(document.getElementById("jform_requestedWidth").value),function(){for(var t=document.getElementById("jform_requestedWidth"),o=[],r=0;r<t.length;r++)o[r]=t[r].value;Joomla.request({url:a()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropImage&path="+e+"&widths="+JSON.stringify(o),method:"GET"})}(),Joomla.MediaManager.Edit.smartcrop.cropper&&Joomla.MediaManager.Edit.smartcrop.cropper.destroy()}};var r=function(e){var a=document.getElementById("image-preview");Joomla.MediaManager.Edit.smartcrop.cropper=new Cropper(a,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:a.offsetWidth,minContainerHeight:a.offsetHeight,crop:function(e){var t,o,a,r;t=Math.round(e.detail.x),o=Math.round(e.detail.y),a=Math.round(e.detail.width),r=Math.round(e.detail.height),Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft=t,Joomla.MediaManager.Edit.smartcrop.cropper.boxTop=o,Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth=a,Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight=r,document.getElementById("jform_data_focus_x").value=t,document.getElementById("jform_data_focus_y").value=o,document.getElementById("jform_data_focus_width").value=a,document.getElementById("jform_data_focus_height").value=r,window.dispatchEvent(new Event("mediaManager.history.point"))}}),a.addEventListener("load",function(){var e=a.naturalWidth/a.naturalHeight;Joomla.MediaManager.Edit.smartcrop.cropper.setAspectRatio(e)});var r=document.getElementById("jform_requestedWidth"),i=r.value;t(i),r.addEventListener("change",function(){o(i);var e=r.value;t(e),i=e})}}();