Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},Joomla.MediaManager.Edit=Joomla.MediaManager.Edit||{},function(){"use strict";var a;a="/images"+(a=function(a){for(var o=window.location.search.substring(1).split("&"),e=0;e<o.length;e++){var t=o[e].split("=");if(decodeURIComponent(t[0])==a)return decodeURIComponent(t[1])}return!1}("path").split(":"))[1];var o=function(o){Joomla.request({url:t()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropBoxData&path="+a+"&width="+o,method:"GET",onSuccess:a=>{if(""!=a){var o=JSON.parse(a);Joomla.MediaManager.Edit.smartcrop.cropper.setData({x:o["box-left"],y:o["box-top"],width:o["box-width"],height:o["box-height"]})}}})};function e(o){var e="&box-left="+Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft+"&box-top="+Joomla.MediaManager.Edit.smartcrop.cropper.boxTop+"&box-width="+Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth+"&box-height="+Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight+"&width="+o;Joomla.request({url:t()+"/administrator/index.php?option=com_media&task=adaptiveimage.setfocus&path="+a+e,method:"GET"})}function t(){var a=window.location.origin,o=window.location.pathname.split("/");return"administrator"!=o[1]?a+"/"+o[1]:a}Joomla.MediaManager.Edit.smartcrop={Activate:function(a){r(a)},Deactivate:function(){e(document.getElementById("jform_requestedWidth").value),Joomla.request({url:t()+"/administrator/index.php?option=com_media&task=adaptiveimage.cropImage&path="+a,method:"GET"}),Joomla.MediaManager.Edit.smartcrop.cropper&&Joomla.MediaManager.Edit.smartcrop.cropper.destroy()}};var r=function(a){var t=document.getElementById("image-preview");Joomla.MediaManager.Edit.smartcrop.cropper=new Cropper(t,{viewMode:1,responsive:!1,restore:!0,autoCrop:!0,movable:!0,zoomable:!1,rotatable:!1,autoCropArea:0,minContainerWidth:t.offsetWidth,minContainerHeight:t.offsetHeight,crop:function(a){var o,e,t,r;o=Math.round(a.detail.x),e=Math.round(a.detail.y),t=Math.round(a.detail.width),r=Math.round(a.detail.height),Joomla.MediaManager.Edit.smartcrop.cropper.boxLeft=o,Joomla.MediaManager.Edit.smartcrop.cropper.boxTop=e,Joomla.MediaManager.Edit.smartcrop.cropper.boxWidth=t,Joomla.MediaManager.Edit.smartcrop.cropper.boxHeight=r,document.getElementById("jform_data_focus_x").value=o,document.getElementById("jform_data_focus_y").value=e,document.getElementById("jform_data_focus_width").value=t,document.getElementById("jform_data_focus_height").value=r,window.dispatchEvent(new Event("mediaManager.history.point"))}}),t.addEventListener("load",function(){var a=t.naturalWidth/t.naturalHeight;Joomla.MediaManager.Edit.smartcrop.cropper.setAspectRatio(a)});var r=document.getElementById("jform_requestedWidth"),i=r.value;o(i),r.addEventListener("change",function(){e(i);var a=r.value;o(a),i=a})}}();